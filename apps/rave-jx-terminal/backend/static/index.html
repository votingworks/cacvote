<!DOCTYPE html>
<head>
  <link rel="stylesheet" href="/output.css" />
  <title>RAVE Jurisdiction Terminal</title>
</head>
<body>
  <div class="h-screen w-screen flex justify-center items-center">
    <div class="flex-col">
      <div class="flex-row mb-2">
        <input type="file" class="election-file hidden" />
        <button
          class="import-election rounded-lg text-3xl bg-purple-500 active:bg-purple-700 disabled:bg-purple-300 text-white p-5 mr-2"
        >
          Import Election
        </button>
      </div>
    </div>
  </div>
</body>
<script type="module">
  const importElectionButton = document.querySelector('.import-election');
  const electionFileInput = document.querySelector('.election-file');

  importElectionButton.addEventListener('click', () => {
    electionFileInput.click();
  });

  electionFileInput.addEventListener('change', async () => {
    const file = electionFileInput.files[0];
    const reader = new FileReader();

    reader.onload = async (event) => {
      const response = await fetch('/api/elections', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: event.target.result,
      });

      if (response.ok) {
        alert('Election imported!');
      } else {
        alert('Election import failed!');
      }
    };

    reader.readAsText(file);
  });
</script>
